清理历史编译结果
rm -f ./tsh ./myspin ./mysplit ./mystop ./myint *.o *~

执行编译结果
gcc -Wall -O2 tsh.c -o tsh gcc -Wall -O2 myspin.c -o myspin gcc -Wall -O2 mysplit.c -o mysplit gcc -Wall -O2 mystop.c -o mystop gcc -Wall -O2 myint.c -o myint

test01
./sdriver.pl -t trace01.txt -s ./tsh -a "-p" # # trace01.txt - Properly terminate on EOF. #
./sdriver.pl -t trace01.txt -s ./tshref -a "-p" # # trace01.txt - Properly terminate on EOF. #

test02
./sdriver.pl -t trace02.txt -s ./tsh -a "-p" # # trace02.txt - Process builtin quit command. #
./sdriver.pl -t trace02.txt -s ./tshref -a "-p" # # trace02.txt - Process builtin quit command. #

test03
./sdriver.pl -t trace03.txt -s ./tsh -a "-p" # # trace03.txt - Run a foreground job. # tsh> quit
./sdriver.pl -t trace03.txt -s ./tshref -a "-p" # # trace03.txt - Run a foreground job. # tsh> quit

test04
./sdriver.pl -t trace04.txt -s ./tsh -a "-p" # # trace04.txt - Run a background job. # tsh> ./myspin 1 & [1] (20913) ./myspin &
./sdriver.pl -t trace04.txt -s ./tshref -a "-p" # # trace04.txt - Run a background job. # tsh> ./myspin 1 & [1] (20922) ./myspin 1 &

test05
./sdriver.pl -t trace05.txt -s ./tsh -a "-p" # # trace05.txt - Process jobs builtin command. # tsh> ./myspin 2 & [1] (20938) ./myspin & tsh> ./myspin 3 & [2] (20940) ./myspin & tsh> jobs [1] (20938) Running ./myspin 2 & [2] (20940) Running ./myspin 3 &
./sdriver.pl -t trace05.txt -s ./tshref -a "-p" # # trace05.txt - Process jobs builtin command. # tsh> ./myspin 2 & [1] (20963) ./myspin 2 & tsh> ./myspin 3 & [2] (20965) ./myspin 3 & tsh> jobs [1] (20963) Running ./myspin 2 & [2] (20965) Running ./myspin 3 &

test06
./sdriver.pl -t trace06.txt -s ./tsh -a "-p" # # trace06.txt - Forward SIGINT to foreground job. # tsh> ./myspin 4 Job [1] (20984) terminated by signal 2
./sdriver.pl -t trace06.txt -s ./tshref -a "-p" # # trace06.txt - Forward SIGINT to foreground job. # tsh> ./myspin 4 Job [1] (20996) terminated by signal 2

test07
./sdriver.pl -t trace07.txt -s ./tsh -a "-p" # # trace07.txt - Forward SIGINT only to foreground job. # tsh> ./myspin 4 & [1] (21015) ./myspin & tsh> ./myspin 5 Job [2] (21017) terminated by signal 2 tsh> jobs [1] (21015) Running ./myspin 4 &
./sdriver.pl -t trace07.txt -s ./tshref -a "-p" # # trace07.txt - Forward SIGINT only to foreground job. # tsh> ./myspin 4 & [1] (21044) ./myspin 4 & tsh> ./myspin 5 Job [2] (21046) terminated by signal 2 tsh> jobs [1] (21044) Running ./myspin 4 &

test08
./sdriver.pl -t trace08.txt -s ./tsh -a "-p" # # trace08.txt - Forward SIGTSTP only to foreground job. # tsh> ./myspin 4 & [1] (21067) ./myspin & tsh> ./myspin 5 Job [2] (21069) terminated by signal 2 tsh> jobs [1] (21067) Running ./myspin 4 &
./sdriver.pl -t trace08.txt -s ./tshref -a "-p" # # trace08.txt - Forward SIGTSTP only to foreground job. # tsh> ./myspin 4 & [1] (21092) ./myspin 4 & tsh> ./myspin 5 Job [2] (21094) stopped by signal 20 tsh> jobs [1] (21092) Running ./myspin 4 & [2] (21094) Stopped ./myspin 5

test09
./sdriver.pl -t trace09.txt -s ./tsh -a "-p" # # trace09.txt - Process bg builtin command # tsh> ./myspin 4 & [1] (21115) ./myspin & tsh> ./myspin 5 Job [2] (21117) terminated by signal 2 tsh> jobs [1] (21115) Running ./myspin 4 & tsh> bg %2 %2: No such job tsh> jobs [1] (21115) Running ./myspin 4 &
./sdriver.pl -t trace09.txt -s ./tshref -a "-p" # # trace09.txt - Process bg builtin command # tsh> ./myspin 4 & [1] (21140) ./myspin 4 & tsh> ./myspin 5 Job [2] (21142) stopped by signal 20 tsh> jobs [1] (21140) Running ./myspin 4 & [2] (21142) Stopped ./myspin 5 tsh> bg %2 [2] (21142) ./myspin 5 tsh> jobs [1] (21140) Running ./myspin 4 & [2] (21142) Running ./myspin 5

test10
./sdriver.pl -t trace10.txt -s ./tsh -a "-p" # # trace10.txt - Process fg builtin command. # tsh> ./myspin 4 & [1] (21178) ./myspin & tsh> fg %1 Job [1] (21178) terminated by signal 2 tsh> jobs tsh> fg %1 %1: No such job tsh> jobs
./sdriver.pl -t trace10.txt -s ./tshref -a "-p" # # trace10.txt - Process fg builtin command. # tsh> ./myspin 4 & [1] (21195) ./myspin 4 & tsh> fg %1 Job [1] (21195) stopped by signal 20 tsh> jobs [1] (21195) Stopped ./myspin 4 & tsh> fg %1 tsh> jobs

test11
./sdriver.pl -t trace11.txt -s ./tsh -a "-p" # # trace11.txt - Forward SIGINT to every process in foreground process group # tsh> ./mysplit 4 Job [1] (21219) terminated by signal 2 tsh> /bin/ps a PID TTY STAT TIME COMMAND 491 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 10767 pts/0 Ss 0:00 /bin/zsh 20859 pts/0 S+ 0:00 sh ./test.sh 21215 pts/0 S+ 0:00 make test11 21216 pts/0 S+ 0:00 /usr/bin/perl ./sdriver.pl -t trace11.txt -s ./tsh -a -p 21217 pts/0 S+ 0:00 ./tsh -p 21229 pts/0 R 0:00 /bin/ps a
./sdriver.pl -t trace11.txt -s ./tshref -a "-p" # # trace11.txt - Forward SIGINT to every process in foreground process group # tsh> ./mysplit 4 Job [1] (21234) terminated by signal 2 tsh> /bin/ps a PID TTY STAT TIME COMMAND 491 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 10767 pts/0 Ss 0:00 /bin/zsh 20859 pts/0 S+ 0:00 sh ./test.sh 21230 pts/0 S+ 0:00 make rtest11 21231 pts/0 S+ 0:00 /usr/bin/perl ./sdriver.pl -t trace11.txt -s ./tshref -a -p 21232 pts/0 S+ 0:00 ./tshref -p 21245 pts/0 R 0:00 /bin/ps a

test12
./sdriver.pl -t trace12.txt -s ./tsh -a "-p" # # trace12.txt - Forward SIGTSTP to every process in foreground process group # tsh> ./mysplit 4 Job [1] (21250) terminated by signal 2 tsh> jobs tsh> /bin/ps a PID TTY STAT TIME COMMAND 491 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 10767 pts/0 Ss 0:00 /bin/zsh 20859 pts/0 S+ 0:00 sh ./test.sh 21246 pts/0 S+ 0:00 make test12 21247 pts/0 S+ 0:00 /usr/bin/perl ./sdriver.pl -t trace12.txt -s ./tsh -a -p 21248 pts/0 S+ 0:00 ./tsh -p 21262 pts/0 R 0:00 /bin/ps a
./sdriver.pl -t trace12.txt -s ./tshref -a "-p" # # trace12.txt - Forward SIGTSTP to every process in foreground process group # tsh> ./mysplit 4 Job [1] (21267) stopped by signal 20 tsh> jobs [1] (21267) Stopped ./mysplit 4 tsh> /bin/ps a PID TTY STAT TIME COMMAND 491 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 10767 pts/0 Ss 0:00 /bin/zsh 20859 pts/0 S+ 0:00 sh ./test.sh 21263 pts/0 S+ 0:00 make rtest12 21264 pts/0 S+ 0:00 /usr/bin/perl ./sdriver.pl -t trace12.txt -s ./tshref -a -p 21265 pts/0 S+ 0:00 ./tshref -p 21267 pts/0 T 0:00 ./mysplit 4 21268 pts/0 T 0:00 ./mysplit 4 21278 pts/0 R 0:00 /bin/ps a

test13
./sdriver.pl -t trace13.txt -s ./tsh -a "-p" # # trace13.txt - Restart every stopped process in process group # tsh> ./mysplit 4 Job [1] (21284) terminated by signal 2 tsh> jobs tsh> /bin/ps a PID TTY STAT TIME COMMAND 491 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 10767 pts/0 Ss 0:00 /bin/zsh 20859 pts/0 S+ 0:00 sh ./test.sh 21280 pts/0 S+ 0:00 make test13 21281 pts/0 S+ 0:00 /usr/bin/perl ./sdriver.pl -t trace13.txt -s ./tsh -a -p 21282 pts/0 S+ 0:00 ./tsh -p 21295 pts/0 R 0:00 /bin/ps a tsh> fg %1 %1: No such job tsh> /bin/ps a PID TTY STAT TIME COMMAND 491 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 10767 pts/0 Ss 0:00 /bin/zsh 20859 pts/0 S+ 0:00 sh ./test.sh 21280 pts/0 S+ 0:00 make test13 21281 pts/0 S+ 0:00 /usr/bin/perl ./sdriver.pl -t trace13.txt -s ./tsh -a -p 21282 pts/0 S+ 0:00 ./tsh -p 21298 pts/0 R 0:00 /bin/ps a
./sdriver.pl -t trace13.txt -s ./tshref -a "-p" # # trace13.txt - Restart every stopped process in process group # tsh> ./mysplit 4 Job [1] (21303) stopped by signal 20 tsh> jobs [1] (21303) Stopped ./mysplit 4 tsh> /bin/ps a PID TTY STAT TIME COMMAND 491 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 10767 pts/0 Ss 0:00 /bin/zsh 20859 pts/0 S+ 0:00 sh ./test.sh 21299 pts/0 S+ 0:00 make rtest13 21300 pts/0 S+ 0:00 /usr/bin/perl ./sdriver.pl -t trace13.txt -s ./tshref -a -p 21301 pts/0 S+ 0:00 ./tshref -p 21303 pts/0 T 0:00 ./mysplit 4 21304 pts/0 T 0:00 ./mysplit 4 21315 pts/0 R 0:00 /bin/ps a tsh> fg %1 tsh> /bin/ps a PID TTY STAT TIME COMMAND 491 tty1 Ss+ 0:00 /sbin/agetty --noclear tty1 linux 10767 pts/0 Ss 0:00 /bin/zsh 20859 pts/0 S+ 0:00 sh ./test.sh 21299 pts/0 S+ 0:00 make rtest13 21300 pts/0 S+ 0:00 /usr/bin/perl ./sdriver.pl -t trace13.txt -s ./tshref -a -p 21301 pts/0 S+ 0:00 ./tshref -p 21325 pts/0 R 0:00 /bin/ps a

test14
./sdriver.pl -t trace14.txt -s ./tsh -a "-p" # # trace14.txt - Simple error handling # tsh> ./bogus ./bogus: Command not found tsh> ./myspin 4 & [1] (21331) ./myspin & tsh> fg fg command requires PID or %jobid argument tsh> bg bg command requires PID or %jobid argument tsh> fg a fg: argument must be a PID or %jobid tsh> bg a bg: argument must be a PID or %jobid tsh> fg 9999999 (9999999): No such process tsh> bg 9999999 (9999999): No such process tsh> fg %2 %2: No such job tsh> fg %1 Job [1] (21331) terminated by signal 2 tsh> bg %2 %2: No such job tsh> bg %1 %1: No such job tsh> jobs
./sdriver.pl -t trace14.txt -s ./tshref -a "-p" # # trace14.txt - Simple error handling # tsh> ./bogus ./bogus: Command not found tsh> ./myspin 4 & [1] (21359) ./myspin 4 & tsh> fg fg command requires PID or %jobid argument tsh> bg bg command requires PID or %jobid argument tsh> fg a fg: argument must be a PID or %jobid tsh> bg a bg: argument must be a PID or %jobid tsh> fg 9999999 (9999999): No such process tsh> bg 9999999 (9999999): No such process tsh> fg %2 %2: No such job tsh> fg %1 Job [1] (21359) stopped by signal 20 tsh> bg %2 %2: No such job tsh> bg %1 [1] (21359) ./myspin 4 & tsh> jobs [1] (21359) Running ./myspin 4 &

test15
./sdriver.pl -t trace15.txt -s ./tsh -a "-p" # # trace15.txt - Putting it all together # tsh> ./bogus ./bogus: Command not found tsh> ./myspin 10 Job [1] (21393) terminated by signal 2 tsh> ./myspin 3 & [1] (21403) ./myspin & tsh> ./myspin 4 & [2] (21405) ./myspin & tsh> jobs [1] (21403) Running ./myspin 3 & [2] (21405) Running ./myspin 4 & tsh> fg %1 Job [1] (21403) terminated by signal 2 tsh> jobs [2] (21405) Running ./myspin 4 & tsh> bg %3 %3: No such job tsh> bg %1 %1: No such job tsh> jobs [2] (21405) Running ./myspin 4 & tsh> fg %1 %1: No such job tsh> quit
./sdriver.pl -t trace15.txt -s ./tshref -a "-p" # # trace15.txt - Putting it all together # tsh> ./bogus ./bogus: Command not found tsh> ./myspin 10 Job [1] (21429) terminated by signal 2 tsh> ./myspin 3 & [1] (21438) ./myspin 3 & tsh> ./myspin 4 & [2] (21440) ./myspin 4 & tsh> jobs [1] (21438) Running ./myspin 3 & [2] (21440) Running ./myspin 4 & tsh> fg %1 Job [1] (21438) stopped by signal 20 tsh> jobs [1] (21438) Stopped ./myspin 3 & [2] (21440) Running ./myspin 4 & tsh> bg %3 %3: No such job tsh> bg %1 [1] (21438) ./myspin 3 & tsh> jobs [1] (21438) Running ./myspin 3 & [2] (21440) Running ./myspin 4 & tsh> fg %1 tsh> quit

test16
                                                                                                                                              ./sdriver.pl -t trace16.txt -s ./tsh -a "-p" # # trace16.txt - Tests whether the shell can handle SIGTSTP and SIGINT # signals that come from other processes instead of the terminal. # tsh> ./mystop 2 Job [1] (21469) stoped by signal 20 tsh> jobs [1] (21469) Stopped ./mystop 2 tsh> ./myint 2 Job [2] (21483) terminated by signal 2
./sdriver.pl -t trace16.txt -s ./tshref -a "-p" # # trace16.txt - Tests whether the shell can handle SIGTSTP and SIGINT # signals that come from other processes instead of the terminal. # tsh> ./mystop 2 Job [1] (21496) stopped by signal 20 tsh> jobs [1] (21496) Stopped ./mystop 2 tsh> ./myint 2 Job [2] (21510) terminated by signal 2
